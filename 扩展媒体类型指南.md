# 扩展媒体类型指南

## 如何添加新的媒体类型

### 1. 在 MediaType 枚举中添加新类型

编辑 `com.dcore.media.MediaType.java`，添加新的枚举值：

```java
public enum MediaType {
    STANDARD(createId("standard")),
    SPECIAL(createId("special")),
    // 添加新类型，例如：
    FIRE(createId("fire")),      // 火焰类型媒体
    ICE(createId("ice")),        // 冰霜类型媒体
    LIGHTNING(createId("lightning")); // 雷电类型媒体
    
    // ... 其他代码保持不变
}
```

### 2. 在配置文件中注册物品和动作

编辑 `config/d-core/media_types.json`：

```json
{
  "special_media_items": {
    "spectrum:amethyst_powder": {
      "amount": 80000,
      "type": "special"
    },
    "modid:fire_powder": {
      "amount": 100000,
      "type": "fire"
    },
    "modid:ice_crystal": {
      "amount": 120000,
      "type": "ice"
    }
  },
  "special_media_actions": {
    "comment": "动作媒体类型配置 - 值支持: standard, special, fire, ice, lightning",
    "d-core:damage_entity": "special",
    "d-core:fire_spell": "fire",
    "d-core:ice_spell": "ice"
  }
}
```

### 3. 注册物品为媒体消耗品

在 `DCoreMediaComponents.java` 中注册物品（或通过配置文件自动注册）：

```java
// 方式1：代码中注册
registry.register(
    firePowderItem,
    HexCardinalComponents.MEDIA_HOLDER,
    stack -> new TypedCCMediaHolder.Static(
        () -> 100000L,
        ADMediaHolder.AMETHYST_DUST_PRIORITY,
        MediaType.FIRE,  // 指定为 FIRE 类型
        stack
    )
);
MediaTypeRegistry.registerItemMediaType(new ResourceLocation("modid", "fire_powder"), MediaType.FIRE);

// 方式2：通过配置文件注册（推荐）
// 只需在 media_types.json 中添加配置即可
```

### 4. 注册动作需要的媒体类型

在 `DCore.java` 中注册（或通过配置文件）：

```java
// 方式1：代码中注册
MediaTypeRegistry.registerActionRequiredType(
    new ResourceLocation(MOD_ID, "fire_spell"), 
    MediaType.FIRE
);

// 方式2：通过配置文件注册（推荐）
// 在 media_types.json 的 special_media_actions 中添加：
// "d-core:fire_spell": "fire"
```

## 配置文件格式说明

### 物品配置 (special_media_items)

```json
{
  "special_media_items": {
    "modid:item_name": {
      "amount": 80000,        // 媒体量（可选，仅用于说明）
      "type": "special"       // 媒体类型：standard, special, fire, ice 等
    }
  }
}
```

### 动作配置 (special_media_actions)

```json
{
  "special_media_actions": {
    "modid:action_name": "special"  // 值直接是媒体类型字符串
  }
}
```

## 注意事项

1. **媒体类型名称**：使用枚举名称（如 `FIRE`）或 ID 路径（如 `fire`）都可以，不区分大小写
2. **默认类型**：如果未指定或类型不存在，默认使用 `STANDARD`
3. **类型隔离**：不同类型的媒体不能互相使用，只能使用对应类型的物品或消耗血量
4. **容器限制**：特殊类型媒体不能存储在标准媒体容器中（需要实现对应的容器系统）

## 示例：添加火焰类型媒体

1. **添加枚举**：
```java
FIRE(createId("fire"))
```

2. **注册物品**（配置文件）：
```json
"modid:fire_powder": {
  "amount": 100000,
  "type": "fire"
}
```

3. **注册动作**（配置文件）：
```json
"d-core:fire_spell": "fire"
```

4. **在代码中注册物品**（如果需要）：
```java
registry.register(
    firePowder,
    HexCardinalComponents.MEDIA_HOLDER,
    stack -> new TypedCCMediaHolder.Static(
        () -> 100000L,
        ADMediaHolder.AMETHYST_DUST_PRIORITY,
        MediaType.FIRE,
        stack
    )
);
```

完成！现在 `d-core:fire_spell` 动作只能使用 `fire` 类型的媒体，不足时会消耗血量。

